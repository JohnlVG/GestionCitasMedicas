ƒ
RD:\PruebasDeSoftware\Prueba2U_F\GestionCitasMedicas\GestionCitasMedicas\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
	DotNetEnv 	
.	 

Env
 
. 
Load 
( 
) 
; 
var

 
configuration

 
=

 
builder

 
.

 
Configuration

 )
;

) *
var 
connectionString 
= 
configuration $
.$ %
GetConnectionString% 8
(8 9
$str9 L
)L M
;M N
var 

dbPassword 
= 
Environment 
. "
GetEnvironmentVariable 3
(3 4
$str4 A
)A B
??C E
stringF L
.L M
EmptyM R
;R S
var 
dbUser 

= 
Environment 
. "
GetEnvironmentVariable /
(/ 0
$str0 9
)9 :
??; =
$str> B
;B C
var 
dbServer 
= 
Environment 
. "
GetEnvironmentVariable 1
(1 2
$str2 =
)= >
??? A
$strB M
;M N
var 

dbDatabase 
= 
Environment 
. "
GetEnvironmentVariable 3
(3 4
$str4 A
)A B
??C E
$strF Q
;Q R
connectionString 
= 
$" 
$str 
{ 
dbServer %
}% &
$str& 0
{0 1

dbDatabase1 ;
}; <
$str< E
{E F
dbUserF L
}L M
$strM W
{W X

dbPasswordX b
}b c
$str	c 
"
 ž
;
ž Ÿ
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddDbContext 
< 
AppDbContext *
>* +
(+ ,
options, 3
=>4 6
options 
. 
UseSqlServer 
( 
connectionString )
)) *
)* +
;+ ,
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app 
. 

UseSwagger 
( 
) 
; 
app 
. 
UseSwaggerUI 
( 
) 
; 
}   
app"" 
."" 
UseHttpsRedirection"" 
("" 
)"" 
;"" 
app$$ 
.$$ 
UseAuthorization$$ 
($$ 
)$$ 
;$$ 
app&& 
.&& 
MapControllers&& 
(&& 
)&& 
;&& 
await(( 
app(( 	
.((	 

RunAsync((
 
((( 
)(( 
;(( ƒ^
qD:\PruebasDeSoftware\Prueba2U_F\GestionCitasMedicas\GestionCitasMedicas\Migrations\20250121055027_InitalCreate.cs
	namespace 	
GestionCitasMedicas
 
. 

Migrations (
{ 
public		 

partial		 
class		 
InitalCreate		 %
:		& '
	Migration		( 1
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
IdDoctor 
= 
table $
.$ %
Column% +
<+ ,
int, /
>/ 0
(0 1
type1 5
:5 6
$str7 <
,< =
nullable> F
:F G
falseH M
)M N
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Nombre 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 G
,G H
	maxLengthI R
:R S
$numT W
,W X
nullableY a
:a b
falsec h
)h i
,i j
Especialidad  
=! "
table# (
.( )
Column) /
</ 0
string0 6
>6 7
(7 8
type8 <
:< =
$str> M
,M N
	maxLengthO X
:X Y
$numZ ]
,] ^
nullable_ g
:g h
falsei n
)n o
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
IdDoctor; C
)C D
;D E
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str !
,! "
columns 
: 
table 
=> !
new" %
{ 

IdPaciente   
=    
table  ! &
.  & '
Column  ' -
<  - .
int  . 1
>  1 2
(  2 3
type  3 7
:  7 8
$str  9 >
,  > ?
nullable  @ H
:  H I
false  J O
)  O P
.!! 

Annotation!! #
(!!# $
$str!!$ 8
,!!8 9
$str!!: @
)!!@ A
,!!A B
Nombre"" 
="" 
table"" "
.""" #
Column""# )
<"") *
string""* 0
>""0 1
(""1 2
type""2 6
:""6 7
$str""8 G
,""G H
	maxLength""I R
:""R S
$num""T W
,""W X
nullable""Y a
:""a b
false""c h
)""h i
,""i j
Apellido## 
=## 
table## $
.##$ %
Column##% +
<##+ ,
string##, 2
>##2 3
(##3 4
type##4 8
:##8 9
$str##: I
,##I J
	maxLength##K T
:##T U
$num##V Y
,##Y Z
nullable##[ c
:##c d
false##e j
)##j k
,##k l
Telefono$$ 
=$$ 
table$$ $
.$$$ %
Column$$% +
<$$+ ,
string$$, 2
>$$2 3
($$3 4
type$$4 8
:$$8 9
$str$$: H
,$$H I
	maxLength$$J S
:$$S T
$num$$U W
,$$W X
nullable$$Y a
:$$a b
false$$c h
)$$h i
}%% 
,%% 
constraints&& 
:&& 
table&& "
=>&&# %
{'' 
table(( 
.(( 

PrimaryKey(( $
((($ %
$str((% 3
,((3 4
x((5 6
=>((7 9
x((: ;
.((; <

IdPaciente((< F
)((F G
;((G H
})) 
))) 
;)) 
migrationBuilder++ 
.++ 
CreateTable++ (
(++( )
name,, 
:,, 
$str,, 
,,, 
columns-- 
:-- 
table-- 
=>-- !
new--" %
{.. 
IdCita// 
=// 
table// "
.//" #
Column//# )
<//) *
int//* -
>//- .
(//. /
type/// 3
://3 4
$str//5 :
,//: ;
nullable//< D
://D E
false//F K
)//K L
.00 

Annotation00 #
(00# $
$str00$ 8
,008 9
$str00: @
)00@ A
,00A B
Fecha11 
=11 
table11 !
.11! "
Column11" (
<11( )
DateTime11) 1
>111 2
(112 3
type113 7
:117 8
$str119 D
,11D E
nullable11F N
:11N O
false11P U
)11U V
,11V W

IdPaciente22 
=22  
table22! &
.22& '
Column22' -
<22- .
int22. 1
>221 2
(222 3
type223 7
:227 8
$str229 >
,22> ?
nullable22@ H
:22H I
false22J O
)22O P
,22P Q
IdDoctor33 
=33 
table33 $
.33$ %
Column33% +
<33+ ,
int33, /
>33/ 0
(330 1
type331 5
:335 6
$str337 <
,33< =
nullable33> F
:33F G
false33H M
)33M N
}44 
,44 
constraints55 
:55 
table55 "
=>55# %
{66 
table77 
.77 

PrimaryKey77 $
(77$ %
$str77% /
,77/ 0
x771 2
=>773 5
x776 7
.777 8
IdCita778 >
)77> ?
;77? @
table88 
.88 

ForeignKey88 $
(88$ %
name99 
:99 
$str99 :
,99: ;
column:: 
::: 
x::  !
=>::" $
x::% &
.::& '
IdDoctor::' /
,::/ 0
principalTable;; &
:;;& '
$str;;( 2
,;;2 3
principalColumn<< '
:<<' (
$str<<) 3
,<<3 4
onDelete==  
:==  !
ReferentialAction==" 3
.==3 4
Cascade==4 ;
)==; <
;==< =
table>> 
.>> 

ForeignKey>> $
(>>$ %
name?? 
:?? 
$str?? =
,??= >
column@@ 
:@@ 
x@@  !
=>@@" $
x@@% &
.@@& '

IdPaciente@@' 1
,@@1 2
principalTableAA &
:AA& '
$strAA( 3
,AA3 4
principalColumnBB '
:BB' (
$strBB) 5
,BB5 6
onDeleteCC  
:CC  !
ReferentialActionCC" 3
.CC3 4
CascadeCC4 ;
)CC; <
;CC< =
}DD 
)DD 
;DD 
migrationBuilderFF 
.FF 
CreateTableFF (
(FF( )
nameGG 
:GG 
$strGG &
,GG& '
columnsHH 
:HH 
tableHH 
=>HH !
newHH" %
{II 
IdProcedimientoJJ #
=JJ$ %
tableJJ& +
.JJ+ ,
ColumnJJ, 2
<JJ2 3
intJJ3 6
>JJ6 7
(JJ7 8
typeJJ8 <
:JJ< =
$strJJ> C
,JJC D
nullableJJE M
:JJM N
falseJJO T
)JJT U
.KK 

AnnotationKK #
(KK# $
$strKK$ 8
,KK8 9
$strKK: @
)KK@ A
,KKA B
DescripcionLL 
=LL  !
tableLL" '
.LL' (
ColumnLL( .
<LL. /
stringLL/ 5
>LL5 6
(LL6 7
typeLL7 ;
:LL; <
$strLL= L
,LLL M
	maxLengthLLN W
:LLW X
$numLLY \
,LL\ ]
nullableLL^ f
:LLf g
falseLLh m
)LLm n
,LLn o
CostoMM 
=MM 
tableMM !
.MM! "
ColumnMM" (
<MM( )
decimalMM) 0
>MM0 1
(MM1 2
typeMM2 6
:MM6 7
$strMM8 G
,MMG H
nullableMMI Q
:MMQ R
falseMMS X
)MMX Y
,MMY Z
IdCitaNN 
=NN 
tableNN "
.NN" #
ColumnNN# )
<NN) *
intNN* -
>NN- .
(NN. /
typeNN/ 3
:NN3 4
$strNN5 :
,NN: ;
nullableNN< D
:NND E
falseNNF K
)NNK L
}OO 
,OO 
constraintsPP 
:PP 
tablePP "
=>PP# %
{QQ 
tableRR 
.RR 

PrimaryKeyRR $
(RR$ %
$strRR% 8
,RR8 9
xRR: ;
=>RR< >
xRR? @
.RR@ A
IdProcedimientoRRA P
)RRP Q
;RRQ R
tableSS 
.SS 

ForeignKeySS $
(SS$ %
nameTT 
:TT 
$strTT >
,TT> ?
columnUU 
:UU 
xUU  !
=>UU" $
xUU% &
.UU& '
IdCitaUU' -
,UU- .
principalTableVV &
:VV& '
$strVV( /
,VV/ 0
principalColumnWW '
:WW' (
$strWW) 1
,WW1 2
onDeleteXX  
:XX  !
ReferentialActionXX" 3
.XX3 4
CascadeXX4 ;
)XX; <
;XX< =
}YY 
)YY 
;YY 
migrationBuilder[[ 
.[[ 
CreateIndex[[ (
([[( )
name\\ 
:\\ 
$str\\ )
,\\) *
table]] 
:]] 
$str]] 
,]] 
column^^ 
:^^ 
$str^^ "
)^^" #
;^^# $
migrationBuilder`` 
.`` 
CreateIndex`` (
(``( )
nameaa 
:aa 
$straa +
,aa+ ,
tablebb 
:bb 
$strbb 
,bb 
columncc 
:cc 
$strcc $
)cc$ %
;cc% &
migrationBuilderee 
.ee 
CreateIndexee (
(ee( )
nameff 
:ff 
$strff 0
,ff0 1
tablegg 
:gg 
$strgg '
,gg' (
columnhh 
:hh 
$strhh  
)hh  !
;hh! "
}ii 	
	protectedll 
overridell 
voidll 
Downll  $
(ll$ %
MigrationBuilderll% 5
migrationBuilderll6 F
)llF G
{mm 	
migrationBuildernn 
.nn 
	DropTablenn &
(nn& '
nameoo 
:oo 
$stroo &
)oo& '
;oo' (
migrationBuilderqq 
.qq 
	DropTableqq &
(qq& '
namerr 
:rr 
$strrr 
)rr 
;rr 
migrationBuildertt 
.tt 
	DropTablett &
(tt& '
nameuu 
:uu 
$struu  
)uu  !
;uu! "
migrationBuilderww 
.ww 
	DropTableww &
(ww& '
namexx 
:xx 
$strxx !
)xx! "
;xx" #
}yy 	
}zz 
}{{ ¢2
iD:\PruebasDeSoftware\Prueba2U_F\GestionCitasMedicas\GestionCitasMedicas\Controllers\DoctoresController.cs
	namespace 	
GestionCitasMedicas
 
. 
Controllers )
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public		 

class		 
DoctoresController		 #
:		$ %
ControllerBase		& 4
{

 
private 
readonly 
AppDbContext %
_context& .
;. /
public 
DoctoresController !
(! "
AppDbContext" .
context/ 6
)6 7
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
ActionResult &
<& '
IEnumerable' 2
<2 3
Doctor3 9
>9 :
>: ;
>; <
GetDoctores= H
(H I
)I J
{ 	
return 
await 
_context !
.! "
Doctores" *
.* +
ToListAsync+ 6
(6 7
)7 8
;8 9
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
ActionResult &
<& '
Doctor' -
>- .
>. /
	GetDoctor0 9
(9 :
int: =
id> @
)@ A
{ 	
var 
doctor 
= 
await 
_context '
.' (
Doctores( 0
.0 1
	FindAsync1 :
(: ;
id; =
)= >
;> ?
if 
( 
doctor 
== 
null 
) 
{   
return!! 
NotFound!! 
(!!  
)!!  !
;!!! "
}"" 
return$$ 
doctor$$ 
;$$ 
}%% 	
[(( 	
HttpPost((	 
](( 
public)) 
async)) 
Task)) 
<)) 
ActionResult)) &
<))& '
Doctor))' -
>))- .
>)). /

PostDoctor))0 :
()): ;
Doctor)); A
doctor))B H
)))H I
{** 	
_context++ 
.++ 
Doctores++ 
.++ 
Add++ !
(++! "
doctor++" (
)++( )
;++) *
await,, 
_context,, 
.,, 
SaveChangesAsync,, +
(,,+ ,
),,, -
;,,- .
return.. 
CreatedAtAction.. "
(.." #
nameof..# )
(..) *
	GetDoctor..* 3
)..3 4
,..4 5
new..6 9
{..: ;
id..< >
=..? @
doctor..A G
...G H
IdDoctor..H P
}..Q R
,..R S
doctor..T Z
)..Z [
;..[ \
}// 	
[22 	
HttpPut22	 
(22 
$str22 
)22 
]22 
public33 
async33 
Task33 
<33 
IActionResult33 '
>33' (
	PutDoctor33) 2
(332 3
int333 6
id337 9
,339 :
Doctor33; A
doctor33B H
)33H I
{44 	
if55 
(55 
id55 
!=55 
doctor55 
.55 
IdDoctor55 %
)55% &
{66 
return77 

BadRequest77 !
(77! "
)77" #
;77# $
}88 
_context:: 
.:: 
Entry:: 
(:: 
doctor:: !
)::! "
.::" #
State::# (
=::) *
EntityState::+ 6
.::6 7
Modified::7 ?
;::? @
try<< 
{== 
await>> 
_context>> 
.>> 
SaveChangesAsync>> /
(>>/ 0
)>>0 1
;>>1 2
}?? 
catch@@ 
(@@ (
DbUpdateConcurrencyException@@ /
)@@/ 0
{AA 
ifBB 
(BB 
!BB 
DoctorExistsBB !
(BB! "
idBB" $
)BB$ %
)BB% &
{CC 
returnDD 
NotFoundDD #
(DD# $
)DD$ %
;DD% &
}EE 
elseFF 
{GG 
throwHH 
;HH 
}II 
}JJ 
returnLL 
	NoContentLL 
(LL 
)LL 
;LL 
}MM 	
[PP 	

HttpDeletePP	 
(PP 
$strPP 
)PP 
]PP 
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
IActionResultQQ '
>QQ' (
DeleteDoctorQQ) 5
(QQ5 6
intQQ6 9
idQQ: <
)QQ< =
{RR 	
varSS 
doctorSS 
=SS 
awaitSS 
_contextSS '
.SS' (
DoctoresSS( 0
.SS0 1
	FindAsyncSS1 :
(SS: ;
idSS; =
)SS= >
;SS> ?
ifTT 
(TT 
doctorTT 
==TT 
nullTT 
)TT 
{UU 
returnVV 
NotFoundVV 
(VV  
)VV  !
;VV! "
}WW 
_contextYY 
.YY 
DoctoresYY 
.YY 
RemoveYY $
(YY$ %
doctorYY% +
)YY+ ,
;YY, -
awaitZZ 
_contextZZ 
.ZZ 
SaveChangesAsyncZZ +
(ZZ+ ,
)ZZ, -
;ZZ- .
return\\ 
	NoContent\\ 
(\\ 
)\\ 
;\\ 
}]] 	
private__ 
bool__ 
DoctorExists__ !
(__! "
int__" %
id__& (
)__( )
{`` 	
returnaa 
_contextaa 
.aa 
Doctoresaa $
.aa$ %
Anyaa% (
(aa( )
eaa) *
=>aa+ -
eaa. /
.aa/ 0
IdDoctoraa0 8
==aa9 ;
idaa< >
)aa> ?
;aa? @
}bb 	
}cc 
}ee ˜;
oD:\PruebasDeSoftware\Prueba2U_F\GestionCitasMedicas\GestionCitasMedicas\Controllers\ProcedimientosController.cs
	namespace 	
GestionCitasMedicas
 
. 
Controllers )
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public		 

class		 $
ProcedimientosController		 )
:		* +
ControllerBase		, :
{

 
private 
readonly 
AppDbContext %
_context& .
;. /
public $
ProcedimientosController '
(' (
AppDbContext( 4
context5 <
)< =
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
ActionResult &
<& '
IEnumerable' 2
<2 3
Procedimiento3 @
>@ A
>A B
>B C
GetProcedimientosD U
(U V
)V W
{ 	
return 
await 
_context !
.! "
Procedimientos" 0
.0 1
ToListAsync1 <
(< =
)= >
;> ?
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
ActionResult &
<& '
Procedimiento' 4
>4 5
>5 6
GetProcedimiento7 G
(G H
intH K
idL N
)N O
{ 	
var 
procedimiento 
= 
await  %
_context& .
.. /
Procedimientos/ =
.= >
	FindAsync> G
(G H
idH J
)J K
;K L
if 
( 
procedimiento 
==  
null! %
)% &
{   
return!! 
NotFound!! 
(!!  
)!!  !
;!!! "
}"" 
return$$ 
procedimiento$$  
;$$  !
}%% 	
['' 	
HttpPost''	 
]'' 
public(( 
async(( 
Task(( 
<(( 
IActionResult(( '
>((' (
PostProcedimiento(() :
(((: ;
[((; <
FromBody((< D
]((D E
Procedimiento((F S
procedimiento((T a
)((a b
{)) 	
if++ 
(++ 
procedimiento++ 
.++ 
IdCita++ $
<=++% '
$num++( )
)++) *
{,, 
return-- 

BadRequest-- !
(--! "
$str--" >
)--> ?
;--? @
}.. 
var11 
cita11 
=11 
await11 
_context11 %
.11% &
Citas11& +
.11+ ,
	FindAsync11, 5
(115 6
procedimiento116 C
.11C D
IdCita11D J
)11J K
;11K L
if22 
(22 
cita22 
==22 
null22 
)22 
{33 
return44 
NotFound44 
(44  
$str44  <
)44< =
;44= >
}55 
procedimiento88 
.88 
Cita88 
=88  
cita88! %
;88% &
_context;; 
.;; 
Procedimientos;; #
.;;# $
Add;;$ '
(;;' (
procedimiento;;( 5
);;5 6
;;;6 7
await<< 
_context<< 
.<< 
SaveChangesAsync<< +
(<<+ ,
)<<, -
;<<- .
return>> 
CreatedAtAction>> "
(>>" #
nameof>># )
(>>) *
GetProcedimiento>>* :
)>>: ;
,>>; <
new>>= @
{>>A B
id>>C E
=>>F G
procedimiento>>H U
.>>U V
IdProcedimiento>>V e
}>>f g
,>>g h
procedimiento>>i v
)>>v w
;>>w x
}?? 	
[EE 	
HttpPutEE	 
(EE 
$strEE 
)EE 
]EE 
publicFF 
asyncFF 
TaskFF 
<FF 
IActionResultFF '
>FF' (
PutProcedimientoFF) 9
(FF9 :
intFF: =
idFF> @
,FF@ A
ProcedimientoFFB O
procedimientoFFP ]
)FF] ^
{GG 	
ifHH 
(HH 
idHH 
!=HH 
procedimientoHH #
.HH# $
IdProcedimientoHH$ 3
)HH3 4
{II 
returnJJ 

BadRequestJJ !
(JJ! "
)JJ" #
;JJ# $
}KK 
_contextMM 
.MM 
EntryMM 
(MM 
procedimientoMM (
)MM( )
.MM) *
StateMM* /
=MM0 1
EntityStateMM2 =
.MM= >
ModifiedMM> F
;MMF G
tryOO 
{PP 
awaitQQ 
_contextQQ 
.QQ 
SaveChangesAsyncQQ /
(QQ/ 0
)QQ0 1
;QQ1 2
}RR 
catchSS 
(SS (
DbUpdateConcurrencyExceptionSS /
)SS/ 0
{TT 
ifUU 
(UU 
!UU 
ProcedimientoExistsUU (
(UU( )
idUU) +
)UU+ ,
)UU, -
{VV 
returnWW 
NotFoundWW #
(WW# $
)WW$ %
;WW% &
}XX 
elseYY 
{ZZ 
throw[[ 
;[[ 
}\\ 
}]] 
return__ 
	NoContent__ 
(__ 
)__ 
;__ 
}`` 	
[cc 	

HttpDeletecc	 
(cc 
$strcc 
)cc 
]cc 
publicdd 
asyncdd 
Taskdd 
<dd 
IActionResultdd '
>dd' (
DeleteProcedimientodd) <
(dd< =
intdd= @
idddA C
)ddC D
{ee 	
varff 
procedimientoff 
=ff 
awaitff  %
_contextff& .
.ff. /
Procedimientosff/ =
.ff= >
	FindAsyncff> G
(ffG H
idffH J
)ffJ K
;ffK L
ifgg 
(gg 
procedimientogg 
==gg  
nullgg! %
)gg% &
{hh 
returnii 
NotFoundii 
(ii  
)ii  !
;ii! "
}jj 
_contextll 
.ll 
Procedimientosll #
.ll# $
Removell$ *
(ll* +
procedimientoll+ 8
)ll8 9
;ll9 :
awaitmm 
_contextmm 
.mm 
SaveChangesAsyncmm +
(mm+ ,
)mm, -
;mm- .
returnoo 
	NoContentoo 
(oo 
)oo 
;oo 
}pp 	
privaterr 
boolrr 
ProcedimientoExistsrr (
(rr( )
intrr) ,
idrr- /
)rr/ 0
{ss 	
returntt 
_contexttt 
.tt 
Procedimientostt *
.tt* +
Anytt+ .
(tt. /
ett/ 0
=>tt1 3
ett4 5
.tt5 6
IdProcedimientott6 E
==ttF H
idttI K
)ttK L
;ttL M
}uu 	
}vv 
}ww ã2
iD:\PruebasDeSoftware\Prueba2U_F\GestionCitasMedicas\GestionCitasMedicas\Controllers\PacienteController.cs
	namespace 	
GestionCitasMedicas
 
. 
Controllers )
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public		 

class		 
PacientesController		 $
:		% &
ControllerBase		' 5
{

 
private 
readonly 
AppDbContext %
_context& .
;. /
public 
PacientesController "
(" #
AppDbContext# /
context0 7
)7 8
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
ActionResult &
<& '
IEnumerable' 2
<2 3
Paciente3 ;
>; <
>< =
>= >
GetPacientes? K
(K L
)L M
{ 	
return 
await 
_context !
.! "
	Pacientes" +
.+ ,
ToListAsync, 7
(7 8
)8 9
;9 :
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
ActionResult &
<& '
Paciente' /
>/ 0
>0 1
GetPaciente2 =
(= >
int> A
idB D
)D E
{ 	
var 
paciente 
= 
await  
_context! )
.) *
	Pacientes* 3
.3 4
	FindAsync4 =
(= >
id> @
)@ A
;A B
if 
( 
paciente 
== 
null  
)  !
{   
return!! 
NotFound!! 
(!!  
)!!  !
;!!! "
}"" 
return$$ 
paciente$$ 
;$$ 
}%% 	
[(( 	
HttpPost((	 
](( 
public)) 
async)) 
Task)) 
<)) 
ActionResult)) &
<))& '
Paciente))' /
>))/ 0
>))0 1
PostPaciente))2 >
())> ?
Paciente))? G
paciente))H P
)))P Q
{** 	
_context++ 
.++ 
	Pacientes++ 
.++ 
Add++ "
(++" #
paciente++# +
)+++ ,
;++, -
await,, 
_context,, 
.,, 
SaveChangesAsync,, +
(,,+ ,
),,, -
;,,- .
return.. 
CreatedAtAction.. "
(.." #
nameof..# )
(..) *
GetPaciente..* 5
)..5 6
,..6 7
new..8 ;
{..< =
id..> @
=..A B
paciente..C K
...K L

IdPaciente..L V
}..W X
,..X Y
paciente..Z b
)..b c
;..c d
}// 	
[22 	
HttpPut22	 
(22 
$str22 
)22 
]22 
public33 
async33 
Task33 
<33 
IActionResult33 '
>33' (
PutPaciente33) 4
(334 5
int335 8
id339 ;
,33; <
Paciente33= E
paciente33F N
)33N O
{44 	
if55 
(55 
id55 
!=55 
paciente55 
.55 

IdPaciente55 )
)55) *
{66 
return77 

BadRequest77 !
(77! "
)77" #
;77# $
}88 
_context:: 
.:: 
Entry:: 
(:: 
paciente:: #
)::# $
.::$ %
State::% *
=::+ ,
EntityState::- 8
.::8 9
Modified::9 A
;::A B
try<< 
{== 
await>> 
_context>> 
.>> 
SaveChangesAsync>> /
(>>/ 0
)>>0 1
;>>1 2
}?? 
catch@@ 
(@@ (
DbUpdateConcurrencyException@@ /
)@@/ 0
{AA 
ifBB 
(BB 
!BB 
PacienteExistsBB #
(BB# $
idBB$ &
)BB& '
)BB' (
{CC 
returnDD 
NotFoundDD #
(DD# $
)DD$ %
;DD% &
}EE 
elseFF 
{GG 
throwHH 
;HH 
}II 
}JJ 
returnLL 
	NoContentLL 
(LL 
)LL 
;LL 
}MM 	
[PP 	

HttpDeletePP	 
(PP 
$strPP 
)PP 
]PP 
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
IActionResultQQ '
>QQ' (
DeletePacienteQQ) 7
(QQ7 8
intQQ8 ;
idQQ< >
)QQ> ?
{RR 	
varSS 
pacienteSS 
=SS 
awaitSS  
_contextSS! )
.SS) *
	PacientesSS* 3
.SS3 4
	FindAsyncSS4 =
(SS= >
idSS> @
)SS@ A
;SSA B
ifTT 
(TT 
pacienteTT 
==TT 
nullTT  
)TT  !
{UU 
returnVV 
NotFoundVV 
(VV  
)VV  !
;VV! "
}WW 
_contextYY 
.YY 
	PacientesYY 
.YY 
RemoveYY %
(YY% &
pacienteYY& .
)YY. /
;YY/ 0
awaitZZ 
_contextZZ 
.ZZ 
SaveChangesAsyncZZ +
(ZZ+ ,
)ZZ, -
;ZZ- .
return\\ 
	NoContent\\ 
(\\ 
)\\ 
;\\ 
}]] 	
private__ 
bool__ 
PacienteExists__ #
(__# $
int__$ '
id__( *
)__* +
{`` 	
returnaa 
_contextaa 
.aa 
	Pacientesaa %
.aa% &
Anyaa& )
(aa) *
eaa* +
=>aa, .
eaa/ 0
.aa0 1

IdPacienteaa1 ;
==aa< >
idaa? A
)aaA B
;aaB C
}bb 	
}cc 
}dd  A
TD:\PruebasDeSoftware\Prueba2U_F\GestionCitasMedicas\GestionCitasMedicas\Entidades.cs
	namespace 	
GestionCitasMedicas
 
{ 
public 

static 
class 
	Entidades !
{ 
public 
class 
Paciente 
{ 	
public		 
required		 
int		 

IdPaciente		  *
{		+ ,
get		- 0
;		0 1
set		2 5
;		5 6
}		7 8
[ 
JsonPropertyName 
( 
$str &
)& '
]' (
public 
required 
string "
Nombre# )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
=8 9
string: @
.@ A
EmptyA F
;F G
[ 
JsonPropertyName 
( 
$str (
)( )
]) *
public 
required 
string "
Apellido# +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
=: ;
string< B
.B C
EmptyC H
;H I
[ 
JsonPropertyName 
( 
$str (
)( )
]) *
private 
string 
telefono #
=$ %
string& ,
., -
Empty- 2
;2 3
public 
string 
Telefono "
{ 
get 
=> 
telefono 
;  
set 
{ 
if 
( 
! 
EsTelefonoValido )
() *
value* /
)/ 0
)0 1
throw 
new !
ArgumentException" 3
(3 4
$str4 O
)O P
;P Q
telefono 
= 
value $
;$ %
} 
} 
private 
static 
bool 
EsTelefonoValido  0
(0 1
string1 7
telefono8 @
)@ A
{   
if!! 
(!! 
string!! 
.!! 
IsNullOrWhiteSpace!! -
(!!- .
telefono!!. 6
)!!6 7
)!!7 8
return"" 
false""  
;""  !
string%% 
cleanedTelefono%% &
=%%' (
new%%) ,
string%%- 3
(%%3 4
telefono%%4 <
.%%< =
Where%%= B
(%%B C
char%%C G
.%%G H
IsDigit%%H O
)%%O P
.%%P Q
ToArray%%Q X
(%%X Y
)%%Y Z
)%%Z [
;%%[ \
return(( 
cleanedTelefono(( &
.((& '
Length((' -
>=((. 0
$num((1 2
&&((3 5
cleanedTelefono((6 E
.((E F
Length((F L
<=((M O
$num((P R
;((R S
})) 
[-- 

JsonIgnore-- 
]-- 
public.. 
ICollection.. 
<.. 
Cita.. #
>..# $
Citas..% *
{..+ ,
get..- 0
;..0 1
set..2 5
;..5 6
}..7 8
=..9 :
new..; >
List..? C
<..C D
Cita..D H
>..H I
(..I J
)..J K
;..K L
}// 	
public11 
class11 
Doctor11 
{22 	
public33 
required33 
int33 
IdDoctor33  (
{33) *
get33+ .
;33. /
set330 3
;333 4
}335 6
[55 
JsonPropertyName55 
(55 
$str55 &
)55& '
]55' (
public66 
required66 
string66 "
Nombre66# )
{66* +
get66, /
;66/ 0
set661 4
;664 5
}666 7
=668 9
string66: @
.66@ A
Empty66A F
;66F G
[88 
JsonPropertyName88 
(88 
$str88 ,
)88, -
]88- .
public99 
required99 
string99 "
Especialidad99# /
{990 1
get992 5
;995 6
set997 :
;99: ;
}99< =
=99> ?
string99@ F
.99F G
Empty99G L
;99L M
[<< 

JsonIgnore<< 
]<< 
public== 
ICollection== 
<== 
Cita== #
>==# $
Citas==% *
{==+ ,
get==- 0
;==0 1
set==2 5
;==5 6
}==7 8
===9 :
new==; >
List==? C
<==C D
Cita==D H
>==H I
(==I J
)==J K
;==K L
}>> 	
public@@ 
class@@ 
Cita@@ 
{AA 	
publicBB 
intBB 
IdCitaBB 
{BB 
getBB  #
;BB# $
setBB% (
;BB( )
}BB* +
[DD 
JsonPropertyNameDD 
(DD 
$strDD %
)DD% &
]DD& '
publicEE 
DateTimeEE 
FechaEE !
{EE" #
getEE$ '
;EE' (
setEE) ,
;EE, -
}EE. /
[GG 
JsonPropertyNameGG 
(GG 
$strGG +
)GG+ ,
]GG, -
publicHH 
intHH 

IdPacienteHH !
{HH" #
getHH$ '
;HH' (
setHH) ,
;HH, -
}HH. /
[JJ 
JsonPropertyNameJJ 
(JJ 
$strJJ )
)JJ) *
]JJ* +
publicKK 
intKK 
IdDoctorKK 
{KK  !
getKK" %
;KK% &
setKK' *
;KK* +
}KK, -
[NN 

JsonIgnoreNN 
]NN 
publicOO 
PacienteOO 
?OO 
PacienteOO %
{OO& '
getOO( +
;OO+ ,
setOO- 0
;OO0 1
}OO2 3
[QQ 

JsonIgnoreQQ 
]QQ 
publicRR 
DoctorRR 
?RR 
DoctorRR !
{RR" #
getRR$ '
;RR' (
setRR) ,
;RR, -
}RR. /
[UU 

JsonIgnoreUU 
]UU 
publicVV 
ICollectionVV 
<VV 
ProcedimientoVV ,
>VV, -
ProcedimientosVV. <
{VV= >
getVV? B
;VVB C
setVVD G
;VVG H
}VVI J
=VVK L
newVVM P
ListVVQ U
<VVU V
ProcedimientoVVV c
>VVc d
(VVd e
)VVe f
;VVf g
}WW 	
public\\ 
class\\ 
Procedimiento\\ "
{]] 	
public^^ 
required^^ 
int^^ 
IdProcedimiento^^  /
{^^0 1
get^^2 5
;^^5 6
set^^7 :
;^^: ;
}^^< =
[`` 
JsonPropertyName`` 
(`` 
$str`` +
)``+ ,
]``, -
publicaa 
requiredaa 
stringaa "
Descripcionaa# .
{aa/ 0
getaa1 4
;aa4 5
setaa6 9
;aa9 :
}aa; <
=aa= >
stringaa? E
.aaE F
EmptyaaF K
;aaK L
[cc 
JsonPropertyNamecc 
(cc 
$strcc %
)cc% &
]cc& '
publicdd 
requireddd 
decimaldd #
Costodd$ )
{dd* +
getdd, /
;dd/ 0
setdd1 4
;dd4 5
}dd6 7
[ff 
JsonPropertyNameff 
(ff 
$strff '
)ff' (
]ff( )
publicgg 
requiredgg 
intgg 
IdCitagg  &
{gg' (
getgg) ,
;gg, -
setgg. 1
;gg1 2
}gg3 4
[jj 
JsonPropertyNamejj 
(jj 
$strjj $
)jj$ %
]jj% &
publickk 
Citakk 
Citakk 
{kk 
getkk "
;kk" #
setkk$ '
;kk' (
}kk) *
=kk+ ,
nullkk- 1
!kk1 2
;kk2 3
}ll 	
}tt 
}uu Ü7
fD:\PruebasDeSoftware\Prueba2U_F\GestionCitasMedicas\GestionCitasMedicas\Controllers\CitasController.cs
	namespace 	
GestionCitasMedicas
 
. 
Controllers )
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public		 

class		 
CitasController		  
:		! "
ControllerBase		# 1
{

 
private 
readonly 
AppDbContext %
_context& .
;. /
public 
CitasController 
( 
AppDbContext +
context, 3
)3 4
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
ActionResult &
<& '
IEnumerable' 2
<2 3
Cita3 7
>7 8
>8 9
>9 :
GetCitas; C
(C D
)D E
{ 	
var 
citas 
= 
await 
_context &
.& '
Citas' ,
. 
Include 
( 
c 
=> 
c 
.  
Paciente  (
)( )
. 
Include 
( 
c 
=> 
c 
.  
Doctor  &
)& '
. 
ToListAsync 
( 
) 
; 
return 
citas 
; 
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public   
async   
Task   
<   
ActionResult   &
<  & '
Cita  ' +
>  + ,
>  , -
GetCita  . 5
(  5 6
int  6 9
id  : <
)  < =
{!! 	
var"" 
cita"" 
="" 
await"" 
_context"" %
.""% &
Citas""& +
.## 
Include## 
(## 
c## 
=>## 
c## 
.##  
Paciente##  (
)##( )
.$$ 
Include$$ 
($$ 
c$$ 
=>$$ 
c$$ 
.$$  
Doctor$$  &
)$$& '
.%% 
FirstOrDefaultAsync%% $
(%%$ %
c%%% &
=>%%' )
c%%* +
.%%+ ,
IdCita%%, 2
==%%3 5
id%%6 8
)%%8 9
;%%9 :
if'' 
('' 
cita'' 
=='' 
null'' 
)'' 
{(( 
return)) 
NotFound)) 
())  
)))  !
;))! "
}** 
return,, 
cita,, 
;,, 
}-- 	
[00 	
HttpPost00	 
]00 
public11 
async11 
Task11 
<11 
ActionResult11 &
<11& '
Cita11' +
>11+ ,
>11, -
PostCita11. 6
(116 7
Cita117 ;
cita11< @
)11@ A
{22 	
_context44 
.44 
Citas44 
.44 
Add44 
(44 
cita44 #
)44# $
;44$ %
await55 
_context55 
.55 
SaveChangesAsync55 +
(55+ ,
)55, -
;55- .
return77 
CreatedAtAction77 "
(77" #
nameof77# )
(77) *
GetCita77* 1
)771 2
,772 3
new774 7
{778 9
id77: <
=77= >
cita77? C
.77C D
IdCita77D J
}77K L
,77L M
cita77N R
)77R S
;77S T
}88 	
[== 	
HttpPut==	 
(== 
$str== 
)== 
]== 
public>> 
async>> 
Task>> 
<>> 
IActionResult>> '
>>>' (
PutCita>>) 0
(>>0 1
int>>1 4
id>>5 7
,>>7 8
Cita>>9 =
cita>>> B
)>>B C
{?? 	
if@@ 
(@@ 
id@@ 
!=@@ 
cita@@ 
.@@ 
IdCita@@ !
)@@! "
{AA 
returnBB 

BadRequestBB !
(BB! "
)BB" #
;BB# $
}CC 
_contextEE 
.EE 
EntryEE 
(EE 
citaEE 
)EE  
.EE  !
StateEE! &
=EE' (
EntityStateEE) 4
.EE4 5
ModifiedEE5 =
;EE= >
tryGG 
{HH 
awaitII 
_contextII 
.II 
SaveChangesAsyncII /
(II/ 0
)II0 1
;II1 2
}JJ 
catchKK 
(KK (
DbUpdateConcurrencyExceptionKK /
)KK/ 0
{LL 
ifMM 
(MM 
!MM 

CitaExistsMM 
(MM  
idMM  "
)MM" #
)MM# $
{NN 
returnOO 
NotFoundOO #
(OO# $
)OO$ %
;OO% &
}PP 
elseQQ 
{RR 
throwSS 
;SS 
}TT 
}UU 
returnWW 
	NoContentWW 
(WW 
)WW 
;WW 
}XX 	
[[[ 	

HttpDelete[[	 
([[ 
$str[[ 
)[[ 
][[ 
public\\ 
async\\ 
Task\\ 
<\\ 
IActionResult\\ '
>\\' (

DeleteCita\\) 3
(\\3 4
int\\4 7
id\\8 :
)\\: ;
{]] 	
var^^ 
cita^^ 
=^^ 
await^^ 
_context^^ %
.^^% &
Citas^^& +
.^^+ ,
	FindAsync^^, 5
(^^5 6
id^^6 8
)^^8 9
;^^9 :
if__ 
(__ 
cita__ 
==__ 
null__ 
)__ 
{`` 
returnaa 
NotFoundaa 
(aa  
)aa  !
;aa! "
}bb 
_contextdd 
.dd 
Citasdd 
.dd 
Removedd !
(dd! "
citadd" &
)dd& '
;dd' (
awaitee 
_contextee 
.ee 
SaveChangesAsyncee +
(ee+ ,
)ee, -
;ee- .
returngg 
	NoContentgg 
(gg 
)gg 
;gg 
}hh 	
privatejj 
booljj 

CitaExistsjj 
(jj  
intjj  #
idjj$ &
)jj& '
{kk 	
returnll 
_contextll 
.ll 
Citasll !
.ll! "
Anyll" %
(ll% &
ell& '
=>ll( *
ell+ ,
.ll, -
IdCitall- 3
==ll4 6
idll7 9
)ll9 :
;ll: ;
}mm 	
}nn 
}oo ¤E
WD:\PruebasDeSoftware\Prueba2U_F\GestionCitasMedicas\GestionCitasMedicas\AppDbContext.cs
	namespace 	
GestionCitasMedicas
 
{ 
public 

class 
AppDbContext 
: 
	DbContext  )
{		 
public 
AppDbContext 
( 
DbContextOptions ,
<, -
AppDbContext- 9
>9 :
options; B
)B C
:D E
baseF J
(J K
optionsK R
)R S
{T U
}V W
public 
DbSet 
< 
	Entidades 
. 
Paciente '
>' (
	Pacientes) 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
=A B
nullC G
!G H
;H I
public 
DbSet 
< 
	Entidades 
. 
Doctor %
>% &
Doctores' /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
=> ?
null@ D
!D E
;E F
public 
DbSet 
< 
	Entidades 
. 
Cita #
># $
Citas% *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
=9 :
null; ?
!? @
;@ A
public 
DbSet 
< 
	Entidades 
. 
Procedimiento ,
>, -
Procedimientos. <
{= >
get? B
;B C
setD G
;G H
}I J
=K L
nullM Q
!Q R
;R S
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
modelBuilder 
. 
Entity 
<  
	Entidades  )
.) *
Paciente* 2
>2 3
(3 4
entity4 :
=>; =
{ 
entity 
. 
ToTable 
( 
$str *
)* +
;+ ,
entity 
. 
HasKey 
( 
p 
=>  "
p# $
.$ %

IdPaciente% /
)/ 0
;0 1
entity 
. 
Property 
(  
p  !
=>" $
p% &
.& '
Nombre' -
)- .
.. /

IsRequired/ 9
(9 :
): ;
.; <
HasMaxLength< H
(H I
$numI L
)L M
;M N
entity 
. 
Property 
(  
p  !
=>" $
p% &
.& '
Apellido' /
)/ 0
.0 1

IsRequired1 ;
(; <
)< =
.= >
HasMaxLength> J
(J K
$numK N
)N O
;O P
entity 
. 
Property 
(  
p  !
=>" $
p% &
.& '
Telefono' /
)/ 0
.0 1
HasMaxLength1 =
(= >
$num> @
)@ A
;A B
}   
)   
;   
modelBuilder## 
.## 
Entity## 
<##  
	Entidades##  )
.##) *
Doctor##* 0
>##0 1
(##1 2
entity##2 8
=>##9 ;
{$$ 
entity%% 
.%% 
ToTable%% 
(%% 
$str%% )
)%%) *
;%%* +
entity&& 
.&& 
HasKey&& 
(&& 
d&& 
=>&&  "
d&&# $
.&&$ %
IdDoctor&&% -
)&&- .
;&&. /
entity'' 
.'' 
Property'' 
(''  
d''  !
=>''" $
d''% &
.''& '
Nombre''' -
)''- .
.''. /

IsRequired''/ 9
(''9 :
)'': ;
.''; <
HasMaxLength''< H
(''H I
$num''I L
)''L M
;''M N
entity(( 
.(( 
Property(( 
(((  
d((  !
=>((" $
d((% &
.((& '
Especialidad((' 3
)((3 4
.((4 5

IsRequired((5 ?
(((? @
)((@ A
.((A B
HasMaxLength((B N
(((N O
$num((O R
)((R S
;((S T
})) 
))) 
;)) 
modelBuilder,, 
.,, 
Entity,, 
<,,  
	Entidades,,  )
.,,) *
Cita,,* .
>,,. /
(,,/ 0
entity,,0 6
=>,,7 9
{-- 
entity.. 
... 
ToTable.. 
(.. 
$str.. &
)..& '
;..' (
entity// 
.// 
HasKey// 
(// 
c// 
=>//  "
c//# $
.//$ %
IdCita//% +
)//+ ,
;//, -
entity00 
.00 
Property00 
(00  
c00  !
=>00" $
c00% &
.00& '
Fecha00' ,
)00, -
.00- .

IsRequired00. 8
(008 9
)009 :
;00: ;
entity22 
.22 
HasOne22 
(22 
c22 
=>22  "
c22# $
.22$ %
Paciente22% -
)22- .
.33 
WithMany33 
(33  
p33  !
=>33" $
p33% &
.33& '
Citas33' ,
)33, -
.44 
HasForeignKey44 $
(44$ %
c44% &
=>44' )
c44* +
.44+ ,

IdPaciente44, 6
)446 7
.55 
OnDelete55 
(55  
DeleteBehavior55  .
.55. /
Cascade55/ 6
)556 7
;557 8
entity77 
.77 
HasOne77 
(77 
c77 
=>77  "
c77# $
.77$ %
Doctor77% +
)77+ ,
.88 
WithMany88 
(88  
d88  !
=>88" $
d88% &
.88& '
Citas88' ,
)88, -
.99 
HasForeignKey99 $
(99$ %
c99% &
=>99' )
c99* +
.99+ ,
IdDoctor99, 4
)994 5
.:: 
OnDelete:: 
(::  
DeleteBehavior::  .
.::. /
Cascade::/ 6
)::6 7
;::7 8
};; 
);; 
;;; 
modelBuilder>> 
.>> 
Entity>> 
<>>  
	Entidades>>  )
.>>) *
Procedimiento>>* 7
>>>7 8
(>>8 9
entity>>9 ?
=>>>@ B
{?? 
entity@@ 
.@@ 
ToTable@@ 
(@@ 
$str@@ /
)@@/ 0
;@@0 1
entityAA 
.AA 
HasKeyAA 
(AA 
pAA 
=>AA  "
pAA# $
.AA$ %
IdProcedimientoAA% 4
)AA4 5
;AA5 6
entityBB 
.BB 
PropertyBB 
(BB  
pBB  !
=>BB" $
pBB% &
.BB& '
DescripcionBB' 2
)BB2 3
.BB3 4

IsRequiredBB4 >
(BB> ?
)BB? @
.BB@ A
HasMaxLengthBBA M
(BBM N
$numBBN Q
)BBQ R
;BBR S
entityCC 
.CC 
PropertyCC 
(CC  
pCC  !
=>CC" $
pCC% &
.CC& '
CostoCC' ,
)CC, -
.CC- .

IsRequiredCC. 8
(CC8 9
)CC9 :
.CC: ;
HasColumnTypeCC; H
(CCH I
$strCCI X
)CCX Y
;CCY Z
entityFF 
.FF 
HasOneFF 
(FF 
pFF 
=>FF  "
pFF# $
.FF$ %
CitaFF% )
)FF) *
.GG 
WithManyGG 
(GG  
cGG  !
=>GG" $
cGG% &
.GG& '
ProcedimientosGG' 5
)GG5 6
.HH 
HasForeignKeyHH $
(HH$ %
pHH% &
=>HH' )
pHH* +
.HH+ ,
IdCitaHH, 2
)HH2 3
.II 
OnDeleteII 
(II  
DeleteBehaviorII  .
.II. /
CascadeII/ 6
)II6 7
;II7 8
}JJ 
)JJ 
;JJ 
}LL 	
}MM 
}NN 